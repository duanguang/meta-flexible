!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){"use strict";var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};!function(t,n,i){function o(e,t){if(!e)throw new Error(D+": "+t)}function r(e,t){e||console.warn(D+": "+t)}function a(){o(!c(),"在使用当前工具库时请勿使用自定义viewpoint meta. viewpoint meta 将会通过当前工具自动计算生成.")}function c(){return n.querySelector('meta[name="viewport"]')}function d(){n.body?n.body.style.fontSize=12*C+"px":n.addEventListener("DOMContentLoaded",d)}function u(e,t){if(!e){var i=c();i?e=i:(e=n.createElement("meta"),e.setAttribute("name","viewport")),e.setAttribute("content",t);var o=k.querySelector("head");if(o)o.appendChild(e);else{var r=n.createElement("div");r.appendChild(e),n.write(r.innerHTML)}}else e.setAttribute("content",t);return e}function l(e){switch(e){case y.TargetDensityDpi:v();break;case y.ScaleRatio:m();break;case y.Rem:s();break;case y.Viewpoint:f();break;default:o(!1,"未知 meta-flexible 方案, plan = "+e)}}function s(){O(1),p()}function f(){O(1),p(!1)}function p(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=void 0;P===R.Width?t=k.clientWidth:P===R.Height?t=k.clientHeight:P===R.Auto&&(t=Math.min(k.clientWidth,k.clientHeight)),e&&t>_&&(t=_);var n=t/F;B&&(n/=b()),k.style.fontSize=n+"px",i.rem=n}function v(){N()}function m(){var e=g(),t=e/L;t>1&&(t=1),O(t)}function h(){if(C>=2){var e=n.createElement("body"),t=n.createElement("div");t.style.border=".5px solid transparent",e.appendChild(t),k.appendChild(e),1===t.offsetHeight&&k.classList.add("hairlines"),k.removeChild(e)}}function w(e){var t=k.clientWidth;e();var n=k.clientWidth;return g()===L?E.Unknown:n===t?E.No:E.Yes}function g(){return t.screen.width}i.version="0.0.9-alpha";var b=function(){var e=void 0,t=function(){return+getComputedStyle(n.documentElement).getPropertyValue("font-size").replace(/px/,"")};return function(){if(!e){var i=n.documentElement.style.cssText;n.documentElement.style.cssText="font-size:100px !important";var o=t();e=o/100,n.documentElement.style.cssText=i}return e}}(),y={TargetDensityDpi:0,ScaleRatio:1,Rem:2,Viewpoint:3},E={Yes:1,No:-1,Unknown:0},R={Width:"width",Height:"height",Auto:"auto"},x={namespace:"meta-flexible",designViewpoint:750,getMetaViewpointTargetDensityDpiContent:function(e,t){return["width="+e,"target-densitydpi=device-dpi","user-scalable=no",t&&"viewport-fit=cover"].filter(Boolean).join(", ")},getMetaViewpointScaleRatioContent:function(e,t){return["width=device-width","initial-scale=1","maximum-scale="+e,"minimum-scale="+e,"user-scalable=no",t&&"viewport-fit=cover"].filter(Boolean).join(", ")},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},plans:[y.TargetDensityDpi,y.ScaleRatio],Plan:y,enableBodyFontSize:!1,enableViewpointFitForIphoneX:!1,remRatio:10,remUpperResizeLimit:540,remResizeDependency:R.Width,client:void 0,disableReportPlanNotWorkingErrorOnce:!0,fixRemManualSettingFontResize:!0},M=e({},x,i),S=M.getMetaViewpointTargetDensityDpiContent,T=M.getMetaViewpointScaleRatioContent,z=M.namespace,D=z,L=M.designViewpoint,W=M.enableViewpointFitForIphoneX,k=n.documentElement,C=t.devicePixelRatio||1,V=M.plans,F=M.remRatio,_=M.remUpperResizeLimit,A=M.disableReportPlanNotWorkingErrorOnce,P=M.remResizeDependency,B=M.fixRemManualSettingFontResize,N=function(){var e=!1,n=0;return t.addEventListener("orientationchange",function(){setTimeout(function(){t.innerWidth!==L&&(n++,n>5&&(n=0),u(void 0,S(L+n/1e3,W)))},250)}),function(){e||(u(void 0,S(L,W)),e=!0)}}(),O=function(){var e=void 0,t=void 0;return function(n){t!==n&&(t=n,e=u(e,T(n,W)))}}(),H=function(){return function(){var e=z+"所使用的所有方案失效, 暂用最后一种方案兜底";A?console.warn(e):setTimeout(function(){return o(!1,e)},0)}}(),j=function(){var e=void 0,t=E.No,n=void 0;return function(){if(e!==k.clientWidth){if(e=k.clientWidth,t===E.Yes)return void l(n);if(0===V.length)return void l(n);for(;t===E.No;){if(void 0!==V[0]&&(n=V[0]),V.length<=0){H();break}t=w(function(){return l(n)}),t===E.No&&V.shift()}t===E.Unknown&&(t=E.No)}}}();!function(){var e=M.enableBodyFontSize;if(!(0,M.isMobile)())return void r(!1,"请确保在移动端下使用"+z);a(),e&&d(),j(),t.addEventListener("resize",function(){var e=void 0;return function(){clearTimeout(e),e=setTimeout(j,300)}}()),t.addEventListener("pageshow",function(e){e.persisted&&j()},!1),h()}()}(window,document,window.__META_FLEXIBLE__=window.__META_FLEXIBLE__||{})});
//# sourceMappingURL=meta-flexible.min.js.map
